nohup: ignoring input
TensorFlow installation not found - running with reduced feature set.
/opt/conda/envs/sketch/lib/python3.10/site-packages/tensorboard_data_server/bin/server: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.33' not found (required by /opt/conda/envs/sketch/lib/python3.10/site-packages/tensorboard_data_server/bin/server)
/opt/conda/envs/sketch/lib/python3.10/site-packages/tensorboard_data_server/bin/server: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by /opt/conda/envs/sketch/lib/python3.10/site-packages/tensorboard_data_server/bin/server)
/opt/conda/envs/sketch/lib/python3.10/site-packages/tensorboard_data_server/bin/server: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.32' not found (required by /opt/conda/envs/sketch/lib/python3.10/site-packages/tensorboard_data_server/bin/server)
Address already in use
Port 5252 is in use by another program. Either identify and stop that program, or start the server with a different port.

[WELCOME] Unfolding configurations...!
{'global_config': {'seed': 5959, 'device': 'cpu', 'is_mp': True}}
{'data_config': {'data_path': './data/', 'dataset_name': 'MNIST', 'num_shards': 200, 'iid': False}}
{'fed_config': {'C': 1.0, 'K': 10, 'R': 5, 'E': 1, 'B': 10, 'criterion': 'torch.nn.CrossEntropyLoss', 'optimizer': 'torch.optim.SGD'}}
{'optim_config': {'lr': 0.005, 'momentum': 0}}
{'init_config': {'init_type': 'xavier', 'init_gain': 1.0, 'gpu_ids': []}}
{'model_config': {'name': 'CNN', 'in_channels': 1, 'hidden_channels': 32, 'num_hiddens': 512, 'num_classes': 10}}
{'log_config': {'log_path': './log/2023-05-01_02:58:37', 'log_name': 'FL.log', 'tb_port': 5252, 'tb_host': '0.0.0.0'}}
{'sketch_config': {'sketch_c': 500000, 'sketch_r': 5, 'k': 50000}}

currently using 10 server(s)
[Round: 0000] ...successfully initialized model (# parameters: 1662752)!
0it [00:00, ?it/s]                  [Round: 0000] ...successfully finished setup of all 10 clients!
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 29.13it/s] 60%|██████    | 6/10 [00:00<00:00, 27.95it/s]100%|██████████| 10/10 [00:00<00:00, 30.79it/s]                                               [Round: 0000] ...successfully transmitted models to all 10 clients!
[Round: 0001] Select clients...!
  0%|          | 0/10 [00:00<?, ?it/s] 50%|█████     | 5/10 [00:00<00:00, 48.35it/s]100%|██████████| 10/10 [00:00<00:00, 39.05it/s]                                               [Round: 0001] ...successfully transmitted models to 10 selected clients!
[Round: 0001] Evaluate selected 10 clients' models...!
	[Client 0000] ...finished evaluation!            
	=> client loss(test): 2.3108            
	=> client accuracy(test): 6.50%

	[Client 0002] ...finished evaluation!            
	=> client loss(test): 2.3000            
	=> client accuracy(test): 8.80%

	[Client 0001] ...finished evaluation!            
	=> client loss(test): 2.3027            
	=> client accuracy(test): 7.00%

	[Client 0004] ...finished evaluation!            
	=> client loss(test): 2.2986            
	=> client accuracy(test): 11.80%

	[Client 0003] ...finished evaluation!            
	=> client loss(test): 2.3011            
	=> client accuracy(test): 8.60%

	[Client 0005] ...finished evaluation!            
	=> client loss(test): 2.2977            
	=> client accuracy(test): 11.00%

	[Client 0007] ...finished evaluation!            
	=> client loss(test): 2.3033            
	=> client accuracy(test): 8.60%

	[Client 0006] ...finished evaluation!            
	=> client loss(test): 2.3001            
	=> client accuracy(test): 10.10%

	[Client 0008] ...finished evaluation!            
	=> client loss(test): 2.3012            
	=> client accuracy(test): 9.70%

	[Client 0009] ...finished evaluation!            
	=> client loss(test): 2.3015            
	=> client accuracy(test): 9.00%

[Round: 0001] Start updating selected client 0000...!
[Round: 0001] Start updating selected client 0001...![Round: 0001] Start updating selected client 0002...!

[Round: 0001] ...client 0000 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0003...!
[Round: 0001] ...client 0002 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0004...!
[Round: 0001] ...client 0001 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0005...!
[Round: 0001] ...client 0003 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0006...!
[Round: 0001] ...client 0004 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0007...!
[Round: 0001] ...client 0005 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0008...!
[Round: 0001] ...client 0006 is selected and updated (with total sample size: 6000)!
[Round: 0001] Start updating selected client 0009...!
[Round: 0001] ...client 0008 is selected and updated (with total sample size: 6000)!
[Round: 0001] ...client 0007 is selected and updated (with total sample size: 6000)!
[Round: 0001] ...client 0009 is selected and updated (with total sample size: 6000)!
[Round: 0001] Evaluate selected 10 clients' models...!
	[Client 0002] ...finished evaluation!            
	=> client loss(train): 0.4253            
	=> client accuracy(train): 88.15%

	[Client 0001] ...finished evaluation!            
	=> client loss(train): 0.5158            
	=> client accuracy(train): 83.43%

	[Client 0000] ...finished evaluation!            
	=> client loss(train): 0.3785            
	=> client accuracy(train): 89.62%

	[Client 0004] ...finished evaluation!            
	=> client loss(train): 0.5670            
	=> client accuracy(train): 81.05%

	[Client 0003] ...finished evaluation!            
	=> client loss(train): 0.4957            
	=> client accuracy(train): 82.72%

	[Client 0005] ...finished evaluation!            
	=> client loss(train): 0.4351            
	=> client accuracy(train): 87.88%

	[Client 0007] ...finished evaluation!            
	=> client loss(train): 0.4548            
	=> client accuracy(train): 86.82%

	[Client 0006] ...finished evaluation!            
	=> client loss(train): 0.5061            
	=> client accuracy(train): 83.57%

	[Client 0008] ...finished evaluation!            
	=> client loss(train): 0.4749            
	=> client accuracy(train): 86.52%

	[Client 0009] ...finished evaluation!            
	=> client loss(train): 0.4810            
	=> client accuracy(train): 84.97%

sampled_client_indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[Round: 0001] Aggregate gradients of 10 clients...!
0it [00:00, ?it/s]1it [00:00,  2.62it/s]2it [00:00,  2.57it/s]3it [00:01,  2.39it/s]4it [00:01,  2.39it/s]5it [00:02,  2.40it/s]6it [00:02,  2.41it/s]7it [00:02,  2.41it/s]8it [00:03,  2.40it/s]9it [00:03,  2.39it/s]10it [00:04,  2.40it/s]                       0it [00:00, ?it/s]1it [00:00,  2.53it/s]2it [00:00,  2.51it/s]3it [00:01,  2.46it/s]4it [00:01,  2.50it/s]5it [00:02,  2.43it/s]6it [00:02,  2.39it/s]7it [00:02,  2.44it/s]8it [00:03,  2.46it/s]9it [00:03,  2.48it/s]10it [00:04,  2.48it/s]                       0it [00:00, ?it/s]1it [00:00,  2.65it/s]2it [00:00,  2.66it/s]3it [00:01,  2.57it/s]4it [00:01,  2.40it/s]5it [00:02,  2.44it/s]6it [00:02,  2.48it/s]7it [00:02,  2.47it/s]8it [00:03,  2.48it/s]9it [00:03,  2.58it/s]10it [00:03,  2.54it/s]                       0it [00:00, ?it/s]1it [00:00,  2.63it/s]2it [00:00,  2.53it/s]3it [00:01,  2.53it/s]4it [00:01,  2.59it/s]5it [00:01,  2.58it/s]6it [00:02,  2.54it/s]7it [00:02,  2.57it/s]8it [00:03,  2.61it/s]9it [00:03,  2.59it/s]10it [00:03,  2.53it/s]                       0it [00:00, ?it/s]1it [00:00,  2.69it/s]2it [00:00,  2.73it/s]3it [00:01,  2.56it/s]4it [00:01,  2.61it/s]5it [00:01,  2.63it/s]6it [00:02,  2.53it/s]7it [00:02,  2.56it/s]8it [00:03,  2.70it/s]9it [00:03,  2.68it/s]10it [00:03,  2.64it/s]                       0it [00:00, ?it/s]1it [00:00,  2.50it/s]2it [00:00,  2.50it/s]3it [00:01,  2.53it/s]4it [00:01,  2.59it/s]5it [00:01,  2.49it/s]6it [00:02,  2.41it/s]7it [00:02,  2.40it/s]8it [00:03,  2.41it/s]9it [00:03,  2.39it/s]10it [00:04,  2.39it/s]                       0it [00:00, ?it/s]1it [00:00,  2.32it/s]2it [00:00,  2.36it/s]3it [00:01,  2.38it/s]4it [00:01,  2.39it/s]5it [00:02,  2.41it/s]6it [00:02,  2.42it/s]7it [00:02,  2.41it/s]8it [00:03,  2.45it/s]9it [00:03,  2.48it/s]10it [00:04,  2.46it/s]                       0it [00:00, ?it/s]1it [00:00,  2.43it/s]2it [00:00,  2.39it/s]3it [00:01,  2.54it/s]4it [00:01,  2.48it/s]5it [00:01,  2.60it/s]6it [00:02,  2.68it/s]7it [00:02,  2.69it/s]8it [00:03,  2.71it/s]9it [00:03,  2.77it/s]10it [00:03,  2.70it/s]                       0it [00:00, ?it/s]1it [00:00,  2.53it/s]2it [00:00,  2.43it/s]3it [00:01,  2.49it/s]4it [00:01,  2.44it/s]5it [00:02,  2.42it/s]6it [00:02,  2.26it/s]7it [00:02,  2.30it/s]8it [00:03,  2.33it/s]9it [00:03,  2.36it/s]10it [00:04,  2.36it/s]                       0it [00:00, ?it/s]1it [00:00,  2.44it/s]2it [00:00,  2.45it/s]3it [00:01,  2.60it/s]4it [00:01,  2.60it/s]5it [00:01,  2.72it/s]6it [00:02,  2.78it/s]7it [00:02,  2.76it/s]8it [00:02,  2.80it/s]9it [00:03,  2.91it/s]10it [00:03,  2.68it/s]                       conv1.weight
conv2.weight
fc1.weight
fc2.weight
[Round: 0001] ...updated weights of 10 clients are successfully averaged!
[Round: 0001] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.4283                
	=> Accuracy: 88.20%

[Round: 0002] Select clients...!
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 29.07it/s] 80%|████████  | 8/10 [00:00<00:00, 37.12it/s]                                              [Round: 0002] ...successfully transmitted models to 10 selected clients!
[Round: 0002] Evaluate selected 10 clients' models...!
	[Client 0001] ...finished evaluation!            
	=> client loss(test): 0.4048            
	=> client accuracy(test): 88.20%

	[Client 0000] ...finished evaluation!            
	=> client loss(test): 0.3810            
	=> client accuracy(test): 90.80%

	[Client 0002] ...finished evaluation!            
	=> client loss(test): 0.4142            
	=> client accuracy(test): 87.70%

	[Client 0003] ...finished evaluation!            
	=> client loss(test): 0.4874            
	=> client accuracy(test): 85.70%

	[Client 0004] ...finished evaluation!            
	=> client loss(test): 0.4640            
	=> client accuracy(test): 87.40%

	[Client 0005] ...finished evaluation!            
	=> client loss(test): 0.3827            
	=> client accuracy(test): 89.50%

	[Client 0006] ...finished evaluation!            
	=> client loss(test): 0.3839            
	=> client accuracy(test): 90.60%

	[Client 0008] ...finished evaluation!            
	=> client loss(test): 0.4812            
	=> client accuracy(test): 86.40%

	[Client 0007] ...finished evaluation!            
	=> client loss(test): 0.4168            
	=> client accuracy(test): 89.40%

	[Client 0009] ...finished evaluation!            
	=> client loss(test): 0.4668            
	=> client accuracy(test): 86.30%

[Round: 0002] Start updating selected client 0000...![Round: 0002] Start updating selected client 0001...!

[Round: 0002] Start updating selected client 0002...!
[Round: 0002] ...client 0001 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0003...!
[Round: 0002] ...client 0002 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0004...!
[Round: 0002] ...client 0000 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0005...!
[Round: 0002] ...client 0003 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0006...!
[Round: 0002] ...client 0005 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0007...!
[Round: 0002] ...client 0004 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0008...!
[Round: 0002] ...client 0006 is selected and updated (with total sample size: 6000)!
[Round: 0002] Start updating selected client 0009...!
[Round: 0002] ...client 0007 is selected and updated (with total sample size: 6000)!
[Round: 0002] ...client 0008 is selected and updated (with total sample size: 6000)!
[Round: 0002] ...client 0009 is selected and updated (with total sample size: 6000)!
[Round: 0002] Evaluate selected 10 clients' models...!
	[Client 0001] ...finished evaluation!            
	=> client loss(train): 0.3340            
	=> client accuracy(train): 90.08%

	[Client 0000] ...finished evaluation!            
	=> client loss(train): 0.2635            
	=> client accuracy(train): 92.77%

	[Client 0002] ...finished evaluation!            
	=> client loss(train): 0.2764            
	=> client accuracy(train): 91.73%

	[Client 0003] ...finished evaluation!            
	=> client loss(train): 0.2526            
	=> client accuracy(train): 92.82%

	[Client 0005] ...finished evaluation!            
	=> client loss(train): 0.3231            
	=> client accuracy(train): 89.38%

	[Client 0004] ...finished evaluation!            
	=> client loss(train): 0.3009            
	=> client accuracy(train): 90.37%

	[Client 0006] ...finished evaluation!            
	=> client loss(train): 0.2524            
	=> client accuracy(train): 92.58%

	[Client 0007] ...finished evaluation!            
	=> client loss(train): 0.3236            
	=> client accuracy(train): 89.88%

	[Client 0008] ...finished evaluation!            
	=> client loss(train): 0.2881            
	=> client accuracy(train): 91.65%

	[Client 0009] ...finished evaluation!            
	=> client loss(train): 0.2634            
	=> client accuracy(train): 92.45%

sampled_client_indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[Round: 0002] Aggregate gradients of 10 clients...!
0it [00:00, ?it/s]1it [00:00,  2.65it/s]2it [00:00,  2.48it/s]3it [00:01,  2.39it/s]4it [00:01,  2.41it/s]5it [00:02,  2.37it/s]6it [00:02,  2.42it/s]7it [00:02,  2.42it/s]8it [00:03,  2.44it/s]9it [00:03,  2.48it/s]10it [00:04,  2.51it/s]                       0it [00:00, ?it/s]1it [00:00,  2.62it/s]2it [00:00,  2.64it/s]3it [00:01,  2.68it/s]4it [00:01,  2.59it/s]5it [00:01,  2.58it/s]6it [00:02,  2.58it/s]7it [00:02,  2.57it/s]8it [00:03,  2.57it/s]9it [00:03,  2.59it/s]10it [00:03,  2.58it/s]                       0it [00:00, ?it/s]1it [00:00,  2.45it/s]2it [00:00,  2.42it/s]3it [00:01,  2.46it/s]4it [00:01,  2.44it/s]5it [00:02,  2.42it/s]6it [00:02,  2.39it/s]7it [00:02,  2.43it/s]8it [00:03,  2.42it/s]9it [00:03,  2.43it/s]10it [00:04,  2.47it/s]                       0it [00:00, ?it/s]1it [00:00,  2.46it/s]2it [00:00,  2.66it/s]3it [00:01,  2.57it/s]4it [00:01,  2.69it/s]5it [00:01,  2.60it/s]6it [00:02,  2.57it/s]7it [00:02,  2.56it/s]8it [00:03,  2.52it/s]9it [00:03,  2.53it/s]10it [00:03,  2.57it/s]                       0it [00:00, ?it/s]1it [00:00,  2.37it/s]2it [00:00,  2.40it/s]3it [00:01,  2.45it/s]4it [00:01,  2.48it/s]5it [00:02,  2.51it/s]6it [00:02,  2.48it/s]7it [00:02,  2.51it/s]8it [00:03,  2.55it/s]9it [00:03,  2.51it/s]10it [00:03,  2.55it/s]                       0it [00:00, ?it/s]1it [00:00,  2.61it/s]2it [00:00,  2.70it/s]3it [00:01,  2.80it/s]4it [00:01,  2.71it/s]5it [00:01,  2.75it/s]6it [00:02,  2.68it/s]7it [00:02,  2.65it/s]8it [00:02,  2.76it/s]9it [00:03,  2.77it/s]10it [00:03,  2.72it/s]                       0it [00:00, ?it/s]1it [00:00,  2.48it/s]2it [00:00,  2.45it/s]3it [00:01,  2.48it/s]4it [00:01,  2.51it/s]5it [00:01,  2.60it/s]6it [00:02,  2.58it/s]7it [00:02,  2.63it/s]8it [00:03,  2.58it/s]9it [00:03,  2.67it/s]10it [00:03,  2.69it/s]                       0it [00:00, ?it/s]1it [00:00,  2.48it/s]2it [00:00,  2.55it/s]3it [00:01,  2.74it/s]4it [00:01,  2.72it/s]5it [00:01,  2.74it/s]6it [00:02,  2.82it/s]7it [00:02,  2.75it/s]8it [00:02,  2.71it/s]9it [00:03,  2.72it/s]10it [00:03,  2.69it/s]                       0it [00:00, ?it/s]1it [00:00,  2.53it/s]2it [00:00,  2.47it/s]3it [00:01,  2.48it/s]4it [00:01,  2.46it/s]5it [00:02,  2.44it/s]6it [00:02,  2.45it/s]7it [00:02,  2.48it/s]8it [00:03,  2.50it/s]9it [00:03,  2.56it/s]10it [00:03,  2.54it/s]                       0it [00:00, ?it/s]1it [00:00,  2.49it/s]2it [00:00,  2.52it/s]3it [00:01,  2.45it/s]4it [00:01,  2.46it/s]5it [00:02,  2.45it/s]6it [00:02,  2.43it/s]7it [00:02,  2.41it/s]8it [00:03,  2.43it/s]9it [00:03,  2.50it/s]10it [00:04,  2.50it/s]                       conv1.weight
conv2.weight
fc1.weight
fc2.weight
[Round: 0002] ...updated weights of 10 clients are successfully averaged!
[Round: 0002] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.2493                
	=> Accuracy: 92.88%

[Round: 0003] Select clients...!
  0%|          | 0/10 [00:00<?, ?it/s] 40%|████      | 4/10 [00:00<00:00, 33.18it/s] 80%|████████  | 8/10 [00:00<00:00, 30.53it/s]                                              [Round: 0003] ...successfully transmitted models to 10 selected clients!
[Round: 0003] Evaluate selected 10 clients' models...!
	[Client 0000] ...finished evaluation!            
	=> client loss(test): 0.2151            
	=> client accuracy(test): 94.60%

	[Client 0002] ...finished evaluation!            
	=> client loss(test): 0.2330            
	=> client accuracy(test): 93.40%

	[Client 0001] ...finished evaluation!            
	=> client loss(test): 0.2306            
	=> client accuracy(test): 93.10%

	[Client 0004] ...finished evaluation!            
	=> client loss(test): 0.2869            
	=> client accuracy(test): 91.60%

	[Client 0003] ...finished evaluation!            
	=> client loss(test): 0.3089            
	=> client accuracy(test): 90.30%

	[Client 0005] ...finished evaluation!            
	=> client loss(test): 0.2075            
	=> client accuracy(test): 93.40%

	[Client 0006] ...finished evaluation!            
	=> client loss(test): 0.1988            
	=> client accuracy(test): 95.40%

	[Client 0007] ...finished evaluation!            
	=> client loss(test): 0.2455            
	=> client accuracy(test): 93.80%

	[Client 0008] ...finished evaluation!            
	=> client loss(test): 0.2863            
	=> client accuracy(test): 91.80%

	[Client 0009] ...finished evaluation!            
	=> client loss(test): 0.2808            
	=> client accuracy(test): 91.40%

[Round: 0003] Start updating selected client 0000...!
[Round: 0003] Start updating selected client 0001...!
[Round: 0003] Start updating selected client 0002...!
[Round: 0003] ...client 0001 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0003...!
[Round: 0003] ...client 0002 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0004...!
[Round: 0003] ...client 0000 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0005...!
[Round: 0003] ...client 0004 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0006...!
[Round: 0003] ...client 0005 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0007...!
[Round: 0003] ...client 0003 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0008...!
[Round: 0003] ...client 0006 is selected and updated (with total sample size: 6000)!
[Round: 0003] Start updating selected client 0009...!
[Round: 0003] ...client 0007 is selected and updated (with total sample size: 6000)!
[Round: 0003] ...client 0008 is selected and updated (with total sample size: 6000)!
[Round: 0003] ...client 0009 is selected and updated (with total sample size: 6000)!
[Round: 0003] Evaluate selected 10 clients' models...!
	[Client 0001] ...finished evaluation!            
	=> client loss(train): 0.2292            
	=> client accuracy(train): 92.78%

	[Client 0000] ...finished evaluation!            
	=> client loss(train): 0.1930            
	=> client accuracy(train): 94.73%

	[Client 0002] ...finished evaluation!            
	=> client loss(train): 0.2556            
	=> client accuracy(train): 91.62%

	[Client 0003] ...finished evaluation!            
	=> client loss(train): 0.2067            
	=> client accuracy(train): 93.98%

	[Client 0004] ...finished evaluation!            
	=> client loss(train): 0.2124            
	=> client accuracy(train): 93.58%

	[Client 0005] ...finished evaluation!            
	=> client loss(train): 0.2175            
	=> client accuracy(train): 93.20%

	[Client 0006] ...finished evaluation!            
	=> client loss(train): 0.2012            
	=> client accuracy(train): 93.97%

	[Client 0008] ...finished evaluation!            
	=> client loss(train): 0.2152            
	=> client accuracy(train): 93.57%

	[Client 0007] ...finished evaluation!            
	=> client loss(train): 0.2175            
	=> client accuracy(train): 93.40%

	[Client 0009] ...finished evaluation!            
	=> client loss(train): 0.2220            
	=> client accuracy(train): 93.10%

sampled_client_indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[Round: 0003] Aggregate gradients of 10 clients...!
0it [00:00, ?it/s]1it [00:00,  2.80it/s]2it [00:00,  2.73it/s]3it [00:01,  2.79it/s]4it [00:01,  2.80it/s]5it [00:01,  2.75it/s]6it [00:02,  2.72it/s]7it [00:02,  2.75it/s]8it [00:02,  2.73it/s]9it [00:03,  2.73it/s]10it [00:03,  2.64it/s]                       0it [00:00, ?it/s]1it [00:00,  2.52it/s]2it [00:00,  2.38it/s]3it [00:01,  2.51it/s]4it [00:01,  2.49it/s]5it [00:02,  2.47it/s]6it [00:02,  2.51it/s]7it [00:02,  2.47it/s]8it [00:03,  2.54it/s]9it [00:03,  2.52it/s]10it [00:04,  2.51it/s]                       0it [00:00, ?it/s]1it [00:00,  2.41it/s]2it [00:00,  2.40it/s]3it [00:01,  2.40it/s]4it [00:01,  2.39it/s]5it [00:02,  2.41it/s]6it [00:02,  2.41it/s]7it [00:02,  2.50it/s]8it [00:03,  2.66it/s]9it [00:03,  2.58it/s]10it [00:04,  2.53it/s]                       0it [00:00, ?it/s]1it [00:00,  2.40it/s]2it [00:00,  2.28it/s]3it [00:01,  2.27it/s]4it [00:01,  2.23it/s]5it [00:02,  2.34it/s]6it [00:02,  2.56it/s]7it [00:02,  2.50it/s]8it [00:03,  2.55it/s]9it [00:03,  2.51it/s]10it [00:04,  2.61it/s]                       0it [00:00, ?it/s]1it [00:00,  2.76it/s]2it [00:00,  3.08it/s]3it [00:01,  2.82it/s]4it [00:01,  2.75it/s]5it [00:01,  2.72it/s]6it [00:02,  2.64it/s]7it [00:02,  2.48it/s]8it [00:03,  2.44it/s]9it [00:03,  2.16it/s]10it [00:04,  2.16it/s]                       0it [00:00, ?it/s]1it [00:00,  2.76it/s]2it [00:00,  2.75it/s]3it [00:01,  2.66it/s]4it [00:01,  2.37it/s]5it [00:01,  2.59it/s]6it [00:02,  2.49it/s]7it [00:02,  2.39it/s]8it [00:03,  2.34it/s]9it [00:03,  2.35it/s]10it [00:04,  2.24it/s]                       0it [00:00, ?it/s]1it [00:00,  2.74it/s]2it [00:00,  2.72it/s]3it [00:01,  2.60it/s]4it [00:01,  2.71it/s]5it [00:01,  2.59it/s]6it [00:02,  2.63it/s]7it [00:02,  2.50it/s]8it [00:03,  2.28it/s]9it [00:03,  2.28it/s]10it [00:04,  2.18it/s]                       0it [00:00, ?it/s]1it [00:00,  2.24it/s]2it [00:00,  2.51it/s]3it [00:01,  2.23it/s]4it [00:01,  2.28it/s]5it [00:02,  2.28it/s]6it [00:02,  2.21it/s]7it [00:03,  2.14it/s]8it [00:03,  2.23it/s]9it [00:03,  2.29it/s]10it [00:04,  2.04it/s]                       0it [00:00, ?it/s]1it [00:00,  2.19it/s]2it [00:00,  2.26it/s]3it [00:01,  2.17it/s]4it [00:01,  2.20it/s]5it [00:02,  2.21it/s]6it [00:02,  2.26it/s]7it [00:03,  2.42it/s]8it [00:03,  2.31it/s]9it [00:03,  2.35it/s]10it [00:04,  2.35it/s]                       0it [00:00, ?it/s]1it [00:00,  2.25it/s]2it [00:00,  2.18it/s]3it [00:01,  2.41it/s]4it [00:01,  2.37it/s]5it [00:02,  2.43it/s]6it [00:02,  2.31it/s]7it [00:03,  2.23it/s]8it [00:03,  2.33it/s]9it [00:03,  2.32it/s]10it [00:04,  2.34it/s]                       conv1.weight
conv2.weight
fc1.weight
fc2.weight
[Round: 0003] ...updated weights of 10 clients are successfully averaged!
[Round: 0003] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.1921                
	=> Accuracy: 94.29%

[Round: 0004] Select clients...!
  0%|          | 0/10 [00:00<?, ?it/s] 30%|███       | 3/10 [00:00<00:00, 29.36it/s] 70%|███████   | 7/10 [00:00<00:00, 31.59it/s]                                              [Round: 0004] ...successfully transmitted models to 10 selected clients!
[Round: 0004] Evaluate selected 10 clients' models...!
	[Client 0000] ...finished evaluation!            
	=> client loss(test): 0.1637            
	=> client accuracy(test): 95.70%

	[Client 0001] ...finished evaluation!            
	=> client loss(test): 0.1774            
	=> client accuracy(test): 94.60%

	[Client 0002] ...finished evaluation!            
	=> client loss(test): 0.1676            
	=> client accuracy(test): 95.50%

	[Client 0003] ...finished evaluation!            
	=> client loss(test): 0.2517            
	=> client accuracy(test): 92.40%

	[Client 0004] ...finished evaluation!            
	=> client loss(test): 0.2157            
	=> client accuracy(test): 92.80%

	[Client 0005] ...finished evaluation!            
	=> client loss(test): 0.1498            
	=> client accuracy(test): 94.80%

	[Client 0007] ...finished evaluation!            
	=> client loss(test): 0.1935            
	=> client accuracy(test): 94.20%

	[Client 0006] ...finished evaluation!            
	=> client loss(test): 0.1503            
	=> client accuracy(test): 96.20%

	[Client 0008] ...finished evaluation!            
	=> client loss(test): 0.2268            
	=> client accuracy(test): 93.50%

	[Client 0009] ...finished evaluation!            
	=> client loss(test): 0.2244            
	=> client accuracy(test): 93.20%

[Round: 0004] Start updating selected client 0000...!
[Round: 0004] Start updating selected client 0001...!
[Round: 0004] Start updating selected client 0002...!
[Round: 0004] ...client 0000 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0003...!
[Round: 0004] ...client 0002 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0004...!
[Round: 0004] ...client 0001 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0005...!
[Round: 0004] ...client 0005 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0006...!
[Round: 0004] ...client 0003 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0007...!
[Round: 0004] ...client 0004 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0008...!
[Round: 0004] ...client 0006 is selected and updated (with total sample size: 6000)!
[Round: 0004] Start updating selected client 0009...!
[Round: 0004] ...client 0007 is selected and updated (with total sample size: 6000)!
[Round: 0004] ...client 0008 is selected and updated (with total sample size: 6000)!
[Round: 0004] ...client 0009 is selected and updated (with total sample size: 6000)!
[Round: 0004] Evaluate selected 10 clients' models...!
	[Client 0000] ...finished evaluation!            
	=> client loss(train): 0.1582            
	=> client accuracy(train): 95.63%

	[Client 0001] ...finished evaluation!            
	=> client loss(train): 0.2058            
	=> client accuracy(train): 93.73%

	[Client 0002] ...finished evaluation!            
	=> client loss(train): 0.2080            
	=> client accuracy(train): 94.08%

	[Client 0003] ...finished evaluation!            
	=> client loss(train): 0.1591            
	=> client accuracy(train): 95.13%

	[Client 0005] ...finished evaluation!            
	=> client loss(train): 0.1975            
	=> client accuracy(train): 94.00%

	[Client 0004] ...finished evaluation!            
	=> client loss(train): 0.1867            
	=> client accuracy(train): 94.82%

	[Client 0006] ...finished evaluation!            
	=> client loss(train): 0.1792            
	=> client accuracy(train): 94.18%

	[Client 0007] ...finished evaluation!            
	=> client loss(train): 0.1814            
	=> client accuracy(train): 94.60%

	[Client 0008] ...finished evaluation!            
	=> client loss(train): 0.1624            
	=> client accuracy(train): 95.33%

	[Client 0009] ...finished evaluation!            
	=> client loss(train): 0.1540            
	=> client accuracy(train): 95.48%

sampled_client_indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[Round: 0004] Aggregate gradients of 10 clients...!
0it [00:00, ?it/s]1it [00:00,  2.67it/s]2it [00:00,  2.39it/s]3it [00:01,  2.58it/s]4it [00:01,  2.43it/s]5it [00:02,  2.28it/s]6it [00:02,  2.16it/s]7it [00:03,  2.28it/s]8it [00:03,  2.34it/s]9it [00:03,  2.37it/s]10it [00:04,  2.34it/s]                       0it [00:00, ?it/s]1it [00:00,  2.12it/s]2it [00:00,  2.06it/s]3it [00:01,  2.05it/s]4it [00:01,  2.06it/s]5it [00:02,  2.04it/s]6it [00:02,  2.12it/s]7it [00:03,  2.61it/s]8it [00:03,  2.57it/s]9it [00:03,  2.75it/s]10it [00:04,  3.02it/s]                       0it [00:00, ?it/s]1it [00:00,  2.47it/s]2it [00:00,  2.56it/s]3it [00:01,  2.34it/s]4it [00:01,  2.25it/s]5it [00:02,  2.24it/s]6it [00:02,  2.19it/s]7it [00:03,  2.26it/s]8it [00:03,  2.48it/s]9it [00:03,  2.45it/s]10it [00:04,  2.45it/s]                       0it [00:00, ?it/s]1it [00:00,  2.33it/s]2it [00:00,  2.22it/s]3it [00:01,  2.06it/s]4it [00:01,  2.19it/s]5it [00:02,  2.42it/s]6it [00:02,  2.55it/s]7it [00:02,  2.51it/s]8it [00:03,  2.33it/s]9it [00:03,  2.30it/s]10it [00:04,  2.33it/s]                       0it [00:00, ?it/s]1it [00:00,  2.29it/s]2it [00:00,  2.00it/s]3it [00:01,  2.20it/s]4it [00:01,  2.25it/s]5it [00:02,  2.38it/s]6it [00:02,  2.40it/s]7it [00:03,  2.25it/s]8it [00:03,  2.26it/s]9it [00:03,  2.26it/s]10it [00:04,  2.28it/s]                       0it [00:00, ?it/s]1it [00:00,  2.86it/s]2it [00:00,  2.67it/s]3it [00:01,  2.73it/s]4it [00:01,  2.62it/s]5it [00:01,  2.72it/s]6it [00:02,  2.68it/s]7it [00:02,  2.41it/s]8it [00:03,  2.45it/s]9it [00:03,  2.31it/s]10it [00:04,  2.21it/s]                       0it [00:00, ?it/s]1it [00:00,  2.22it/s]2it [00:00,  2.52it/s]3it [00:01,  2.65it/s]4it [00:01,  2.57it/s]5it [00:01,  2.54it/s]6it [00:02,  2.63it/s]7it [00:02,  2.44it/s]8it [00:03,  2.34it/s]9it [00:03,  2.17it/s]10it [00:04,  2.18it/s]                       0it [00:00, ?it/s]1it [00:00,  2.42it/s]2it [00:00,  2.34it/s]3it [00:01,  2.32it/s]4it [00:01,  2.22it/s]5it [00:02,  2.14it/s]6it [00:02,  2.09it/s]7it [00:03,  2.20it/s]8it [00:03,  2.30it/s]9it [00:03,  2.57it/s]10it [00:04,  2.99it/s]                       0it [00:00, ?it/s]1it [00:00,  2.44it/s]2it [00:00,  2.01it/s]3it [00:01,  2.22it/s]4it [00:01,  2.40it/s]5it [00:02,  2.47it/s]6it [00:02,  2.29it/s]7it [00:03,  2.31it/s]8it [00:03,  2.29it/s]9it [00:03,  2.43it/s]10it [00:04,  2.47it/s]                       0it [00:00, ?it/s]1it [00:00,  1.99it/s]2it [00:00,  2.16it/s]3it [00:01,  2.18it/s]4it [00:01,  2.29it/s]5it [00:02,  2.35it/s]6it [00:02,  2.39it/s]7it [00:03,  2.28it/s]8it [00:03,  2.26it/s]9it [00:03,  2.26it/s]10it [00:04,  2.20it/s]                       conv1.weight
conv2.weight
fc1.weight
fc2.weight
[Round: 0004] ...updated weights of 10 clients are successfully averaged!
[Round: 0004] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.1566                
	=> Accuracy: 95.37%

[Round: 0005] Select clients...!
  0%|          | 0/10 [00:00<?, ?it/s] 50%|█████     | 5/10 [00:00<00:00, 41.50it/s]100%|██████████| 10/10 [00:00<00:00, 39.16it/s]                                               [Round: 0005] ...successfully transmitted models to 10 selected clients!
[Round: 0005] Evaluate selected 10 clients' models...!
	[Client 0001] ...finished evaluation!            
	=> client loss(test): 0.1441            
	=> client accuracy(test): 95.60%

	[Client 0002] ...finished evaluation!            
	=> client loss(test): 0.1402            
	=> client accuracy(test): 95.90%

	[Client 0000] ...finished evaluation!            
	=> client loss(test): 0.1369            
	=> client accuracy(test): 96.00%

	[Client 0005] ...finished evaluation!            
	=> client loss(test): 0.1211            
	=> client accuracy(test): 96.50%

	[Client 0003] ...finished evaluation!            
	=> client loss(test): 0.2117            
	=> client accuracy(test): 93.80%

	[Client 0004] ...finished evaluation!            
	=> client loss(test): 0.1728            
	=> client accuracy(test): 94.80%

	[Client 0006] ...finished evaluation!            
	=> client loss(test): 0.1228            
	=> client accuracy(test): 96.90%

	[Client 0008] ...finished evaluation!            
	=> client loss(test): 0.1827            
	=> client accuracy(test): 94.60%

	[Client 0007] ...finished evaluation!            
	=> client loss(test): 0.1612            
	=> client accuracy(test): 95.30%

	[Client 0009] ...finished evaluation!            
	=> client loss(test): 0.1720            
	=> client accuracy(test): 94.30%

[Round: 0005] Start updating selected client 0000...!
[Round: 0005] Start updating selected client 0001...!
[Round: 0005] Start updating selected client 0002...!
[Round: 0005] ...client 0002 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0003...!
[Round: 0005] ...client 0001 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0004...!
[Round: 0005] ...client 0000 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0005...!
[Round: 0005] ...client 0004 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0006...!
[Round: 0005] ...client 0003 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0007...!
[Round: 0005] ...client 0005 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0008...!
[Round: 0005] ...client 0007 is selected and updated (with total sample size: 6000)!
[Round: 0005] Start updating selected client 0009...!
[Round: 0005] ...client 0006 is selected and updated (with total sample size: 6000)!
[Round: 0005] ...client 0008 is selected and updated (with total sample size: 6000)!
[Round: 0005] ...client 0009 is selected and updated (with total sample size: 6000)!
[Round: 0005] Evaluate selected 10 clients' models...!
	[Client 0000] ...finished evaluation!            
	=> client loss(train): 0.1416            
	=> client accuracy(train): 96.22%

	[Client 0002] ...finished evaluation!            
	=> client loss(train): 0.1415            
	=> client accuracy(train): 95.67%

	[Client 0001] ...finished evaluation!            
	=> client loss(train): 0.1444            
	=> client accuracy(train): 95.85%

	[Client 0003] ...finished evaluation!            
	=> client loss(train): 0.1309            
	=> client accuracy(train): 96.27%

	[Client 0005] ...finished evaluation!            
	=> client loss(train): 0.1516            
	=> client accuracy(train): 95.13%

	[Client 0004] ...finished evaluation!            
	=> client loss(train): 0.1511            
	=> client accuracy(train): 95.55%

	[Client 0007] ...finished evaluation!            
	=> client loss(train): 0.1397            
	=> client accuracy(train): 95.97%

	[Client 0008] ...finished evaluation!            
	=> client loss(train): 0.1508            
	=> client accuracy(train): 95.35%

	[Client 0006] ...finished evaluation!            
	=> client loss(train): 0.1616            
	=> client accuracy(train): 95.25%

	[Client 0009] ...finished evaluation!            
	=> client loss(train): 0.1427            
	=> client accuracy(train): 96.00%

sampled_client_indices: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[Round: 0005] Aggregate gradients of 10 clients...!
0it [00:00, ?it/s]1it [00:00,  3.66it/s]2it [00:00,  3.63it/s]3it [00:00,  3.79it/s]4it [00:01,  3.71it/s]5it [00:01,  3.66it/s]6it [00:01,  3.77it/s]7it [00:01,  3.63it/s]8it [00:02,  3.73it/s]9it [00:02,  3.59it/s]10it [00:02,  3.56it/s]                       0it [00:00, ?it/s]1it [00:00,  3.20it/s]2it [00:00,  3.59it/s]3it [00:00,  3.53it/s]4it [00:01,  3.49it/s]5it [00:01,  3.51it/s]6it [00:01,  3.61it/s]7it [00:01,  3.61it/s]8it [00:02,  3.72it/s]9it [00:02,  3.83it/s]10it [00:02,  4.26it/s]                       0it [00:00, ?it/s]1it [00:00,  3.85it/s]2it [00:00,  3.80it/s]3it [00:00,  3.61it/s]4it [00:01,  3.54it/s]5it [00:01,  3.73it/s]6it [00:01,  3.72it/s]7it [00:01,  3.52it/s]8it [00:02,  3.59it/s]9it [00:02,  3.52it/s]10it [00:02,  3.43it/s]                       0it [00:00, ?it/s]1it [00:00,  3.66it/s]2it [00:00,  3.71it/s]3it [00:00,  3.31it/s]4it [00:01,  3.42it/s]5it [00:01,  3.72it/s]6it [00:01,  3.72it/s]7it [00:01,  3.63it/s]8it [00:02,  3.62it/s]9it [00:02,  3.59it/s]10it [00:02,  3.54it/s]                       0it [00:00, ?it/s]1it [00:00,  3.77it/s]2it [00:00,  3.75it/s]3it [00:00,  3.45it/s]4it [00:01,  3.39it/s]5it [00:01,  3.35it/s]6it [00:01,  3.67it/s]7it [00:01,  3.67it/s]8it [00:02,  3.60it/s]9it [00:02,  3.57it/s]10it [00:02,  3.69it/s]                       0it [00:00, ?it/s]1it [00:00,  3.75it/s]2it [00:00,  3.60it/s]3it [00:00,  3.66it/s]4it [00:00,  4.33it/s]5it [00:01,  4.09it/s]6it [00:01,  4.49it/s]7it [00:01,  4.16it/s]8it [00:02,  3.83it/s]9it [00:02,  3.95it/s]10it [00:02,  3.93it/s]                       0it [00:00, ?it/s]1it [00:00,  3.64it/s]2it [00:00,  3.75it/s]3it [00:00,  3.98it/s]4it [00:01,  3.89it/s]5it [00:01,  4.07it/s]7it [00:01,  5.73it/s]8it [00:01,  5.13it/s]9it [00:02,  4.58it/s]10it [00:02,  4.30it/s]                       0it [00:00, ?it/s]1it [00:00,  3.60it/s]2it [00:00,  3.57it/s]3it [00:00,  3.71it/s]4it [00:01,  3.75it/s]5it [00:01,  3.77it/s]6it [00:01,  3.72it/s]7it [00:01,  4.21it/s]8it [00:01,  4.99it/s]9it [00:02,  4.48it/s]10it [00:02,  4.08it/s]                       0it [00:00, ?it/s]1it [00:00,  3.56it/s]2it [00:00,  3.38it/s]3it [00:00,  3.57it/s]4it [00:01,  3.73it/s]5it [00:01,  3.78it/s]6it [00:01,  3.69it/s]7it [00:01,  3.55it/s]8it [00:02,  3.58it/s]9it [00:02,  3.61it/s]10it [00:02,  3.67it/s]                       0it [00:00, ?it/s]1it [00:00,  3.42it/s]2it [00:00,  3.76it/s]3it [00:00,  3.81it/s]4it [00:01,  3.73it/s]5it [00:01,  3.68it/s]6it [00:01,  3.68it/s]7it [00:01,  3.59it/s]8it [00:02,  3.68it/s]9it [00:02,  3.61it/s]10it [00:02,  3.62it/s]                       conv1.weight
conv2.weight
fc1.weight
fc2.weight
[Round: 0005] ...updated weights of 10 clients are successfully averaged!
[Round: 0005] Evaluate global model's performance...!                
	[Server] ...finished evaluation!                
	=> Loss: 0.1309                
	=> Accuracy: 96.03%

  0%|          | 0/10 [00:00<?, ?it/s]                                      [Round: 0005] ...successfully transmitted models to all 10 clients!
...done all learning process!
...exit program!
